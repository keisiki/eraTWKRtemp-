;
;슬롯의 메인 프로그램
;


@CASINO_SLOT
;릴 배열
;	왼쪽안 오른쪽 
;1	REP 	MEL 	BEL
;2	BL7 	BL7 	BL7
;3	CHE 	REP 	MEL
;4	MEL 	BEL 	CHE
;5	BEL 	CHE 	REP
;6	REP 	CHE 	BEL
;7	CHE 	BAR 	RD7
;8	BAR 	REP 	MEL
;9	MEL 	BEL 	BAR
;10	BEL 	CHE 	REP
;11	REP 	RD7 	BEL
;12	BAR 	CHE 	BEL
;13	CHE 	REP 	MEL
;14	MEL 	BEL 	CHE
;15	BEL 	BAR 	REP
;16	REP 	MEL 	BEL
;17	RD7 	CHE 	BAR
;18	CHE 	REP 	MEL
;19	MEL 	BEL 	CHE
;20	BEL 	CHE 	REP

;도안 일람
;1 RD7 빨강 7(보너스 도안)
;2 BL7 파랑 7(보너스 도안)
;3 BEL 벨
;4 CHE 체리
;5 MEL 수박
;6 BAR BAR(보너스 도안)
;7 REP 리플레이
;8 NUL 미선택

;=============================
;변수 정의
;=============================
#DIM 초기소지카리스마
#DIM 총회전수
#DIM 전회당선으로부터의회전수
#DIM 단주기련개시시소지카리스마

#DIM 오토모드
#DIM Freeze회수
#DIM CONST 검정회수 = 100000

#DIM 당선이력, 11
#DIM 당선종류이력, 11
#DIM 당선매수이력, 11

#DIM 소역카운터, 100

#DIM 정보패널표시페이지

;일회전 분의 부금은 3 카리스마
#DIM CONST 부금 = 3

;각 도안의 약칭(B_A_R만 5 문자인데 주의!!)
#DIM CONST RD7 = 1
#DIM CONST BL7 = 2
#DIM CONST BEL = 3
#DIM CONST CHE = 4
#DIM CONST MEL = 5
#DIM CONST B_A_R = 6
#DIM CONST REP = 7
#DIM CONST NUL = 8

;당선소역의 종류
#DIM CONST 당선소역_적7보너스 = 0
#DIM CONST 당선소역_청7보너스 = 1
#DIM CONST 당선소역_레귤러보너스 = 2
#DIM CONST 당선소역_중체리 = 3
#DIM CONST 당선소역_강체리 = 4
#DIM CONST 당선소역_약체리 = 5
#DIM CONST 당선소역_강수박 = 6
#DIM CONST 당선소역_약수박 = 7
#DIM CONST 당선소역_벨 = 8
#DIM CONST 당선소역_리플레이 = 9
#DIM CONST 당선소역_탈락 = 99
;테두리의 색
#DIM 색_범위
#DIM CONST 삭제행수 = 51

#DIM 도안_좌상
#DIM 도안_왼쪽안
#DIM 도안_좌하
#DIM 도안_나카가미
#DIM 도안_상당히
#DIM 도안_나카시타
#DIM 도안_우상
#DIM 도안_오른쪽안
#DIM 도안_우하
#DIM 암전_좌상
#DIM 암전_왼쪽안
#DIM 암전_좌하
#DIM 암전_나카가미
#DIM 암전_상당히
#DIM 암전_나카시타
#DIM 암전_우상
#DIM 암전_오른쪽안
#DIM 암전_우하

;NUL가 DIM중에서 사용할 수 없기 때문에 직치는 것
#DIM 도안_좌상_회전중
#DIM 도안_왼쪽안_회전중
#DIM 도안_좌하_회전중
#DIM 도안_나카가미_회전중
#DIM 도안_상당히_회전중
#DIM 도안_나카시타_회전중
#DIM 도안_우상_회전중
#DIM 도안_오른쪽안_회전중
#DIM 도안_우하_회전중
#DIM 암전_좌상_회전중
#DIM 암전_왼쪽안_회전중
#DIM 암전_좌하_회전중
#DIM 암전_나카가미_회전중
#DIM 암전_상당히_회전중
#DIM 암전_나카시타_회전중
#DIM 암전_우상_회전중
#DIM 암전_오른쪽안_회전중
#DIM 암전_우하_회전중

#DIM 설정
#DIM 내부상태
#DIM 단주기련계속율
#DIM 단주기련세트수
#DIM 누계단주기련세트수
#DIM 징조
#DIM 당선한소역
#DIM 당선한BB종류
#DIM 소역추첨하지않아
#DIM 투입카리스마

;=============================
;각 변수의 초기화
;=============================
;후후 상황에 따라 테두리의 색을 바꿀 예정 있어
색_범위 = 0xE6B422
초기소지카리스마 = MONEY:2
단주기련개시시소지카리스마 = 0
총회전수 = 0
전회당선으로부터의회전수 = 0

오토모드 = 0
Freeze회수 = 0

단주기련세트수 = 0
누계단주기련세트수 = 0

정보패널표시페이지 = 0

;0회전 당선이 존재하지 않기 때문에 0으로 초기화
VARSET 당선이력, 0

VARSET 당선종류이력, -1
VARSET 당선매수이력, 0

VARSET 소역카운터, 0

도안_좌상 = REP
도안_왼쪽안 = RD7
도안_좌하 = CHE
도안_나카가미 = CHE
도안_상당히 = RD7
도안_나카시타 = CHE
도안_우상 = BEL
도안_오른쪽안 = RD7
도안_우하 = MEL
암전_좌상 = 0
암전_왼쪽안 = 0
암전_좌하 = 0
암전_나카가미 = 0
암전_상당히 = 0
암전_나카시타 = 0
암전_우상 = 0
암전_오른쪽안 = 0
암전_우하 = 0

도안_좌상_회전중 = NUL
도안_왼쪽안_회전중 = NUL
도안_좌하_회전중 = NUL
도안_나카가미_회전중 = NUL
도안_상당히_회전중 = NUL
도안_나카시타_회전중 = NUL
도안_우상_회전중 = NUL
도안_오른쪽안_회전중 = NUL
도안_우하_회전중 = NUL
암전_좌상_회전중 = 0
암전_왼쪽안_회전중 = 0
암전_좌하_회전중 = 0
암전_나카가미_회전중 = 0
암전_상당히_회전중 = 0
암전_나카시타_회전중 = 0
암전_우상_회전중 = 0
암전_오른쪽안_회전중 = 0
암전_우하_회전중 = 0

;숫자에 의해 여러 가지 기대치가 바뀌는 아레(내부상태와는 다르다)
;설정 = RAND(6) + 1
CALL 설정결정(설정)


;내부상태:기계내 상태를 나타낸다
;1:통상,2:고확( 각 플래그에 의한 추첨이 2회가 된다)
;3초고확:( 각 플래그에 의한 추첨이 3회가 된다),4:단주기련(천정 32 G),  5Freeze(얼다)
내부상태 = 1

;단주기련계속율:내부상태가 32 G련 때의 루프 계속율
;0~95의 값이 들어올 예정
단주기련계속율= 0
;발생하고 있지 않을 때는―1, 발생했을 경우 1 게임 마다 값을 줄여 0이 되면(자) 당선
징조 = -1

;1하지만 서 있는 경우소역추첨을 실시하지 않는다
;정보 패널의 조작을 실시하면 조금 전 성립한 소역에 의한 각종 추첨을 또 가 버리기 (위해)때문에 이 플래그를 세운다
;무추첨 모드 라든지도 악용 성과 그렇게
소역추첨하지않아 = 0

;당선한소역 
;0:스칼렛BB당선
;1:이자요이BB당선
;2:REG 당선
;3:중단 체리 당선
;4:강체리 당선
;5:약체리 당선
;6:강수박 당선
;7:약수박 당선
;8:벨 당선
;9:리플레이 당선
;99:탈락
당선한소역 = 당선소역_탈락

;당선한BB종류　-1:당선하고 있지 않아,0:스칼렛BB당선,1:이자요이BB당선, 2:REG 당선
당선한BB종류 = -1

;=============================
;초기 문장 표시
;=============================
PRINTW 이쪽은 슬롯의 코너입니다.
PRINTW 천천히 기대해 주세요.

$INPUT_LOOP
CALL SLOT_정보패널표시(정보패널표시페이지, 총회전수, 전회당선으로부터의회전수, 누계단주기련세트수, 당선이력, 당선종류이력, 당선매수이력, 소역카운터)
CALL SLOT_전체표시(색_범위, 도안_좌상, 도안_왼쪽안, 도안_좌하, 도안_나카가미, 도안_상당히, 도안_나카시타, 도안_우상, 도안_오른쪽안, 도안_우하, 암전_좌상, 암전_왼쪽안, 암전_좌하, 암전_나카가미, 암전_상당히, 암전_나카시타, 암전_우상, 암전_오른쪽안, 암전_우하)
DRAWLINE
;=================================
;PRINTL1행을 사용해 메시지를 삽입
;=================================
CALL 한마디메시지(단주기련세트수, 설정, 징조, 당선한BB종류, 내부상태, 단주기련계속율, 당선한소역 , 전회당선으로부터의회전수, 단주기련개시시소지카리스마)

PRINTFORML 소지 카리스마 {MONEY:2} 카리스마차매 {MONEY:2-초기소지카리스마}
PRINTFORML 회전수 {총회전수}G 전회의 적중으로부터{전회당선으로부터의회전수}G
PRINTFORML [0] - 슬롯을 그만둔다
PRINTFORML [2] - 정보 패널의 조작
PRINTFORML [1] - 슬롯을 돌린다

;=============================
;여러가지 지만 수정 처리
;=============================
;당선하고 있었을 경우 징조, 당선한BB종류를―1에 세트 다시 한다
SIF 징조 == 0
	징조 = -1
SIF 당선한BB종류 > -1
	당선한BB종류 = -1

;Freeze(얼다) 했을 경우 32 G련상태에 세트
SIF 내부상태 == 5
	내부상태 = 4
;단주기련계속율이 95%를 넘었을 경우 95%에 되돌린다(레어소역 너무 당기는 곳 신음한다)
SIF 단주기련계속율> 95
	단주기련계속율= 95
	
;정보 패널의 조작 버튼을 눌러 여기로 돌아왔을 경우 조금 전 당긴 소역으로 다시 한번 추첨을 실시하기 (위해)때문에
;이 플래그가 서 있으면(자) 강제적으로 소역에 의한 추첨을 스킵 한다(정보 패널의 조작 선택시에 플래그는 선다)
IF 소역추첨하지않아
	소역추첨하지않아 = 0
	GOTO 추첨마지막
ENDIF
;=====================================
;이번 맞고 있던 소역에 대응한 추첨
;=====================================
$소역추첨개시
;~~~~~~~~~~~~~~~~~~~~~~~
;32 G련최종 게임의 경우
;~~~~~~~~~~~~~~~~~~~~~~~
IF 내부상태 == 4 && 전회당선으로부터의회전수 >= 31
	
	;성립한 플래그에 의해 변화
	SELECTCASE 당선한소역
	
	;3:안체리 당선의 경우(계속 확정)
	CASE 당선소역_중체리
		
		;단주기련계속율 추첨
		;단주기련계속율을 95%에 덧쓰기
		단주기련계속율= 95
		
		;계속 확정 추첨
		IF RAND(100) < 중단체리_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			징조 = 0
			
			GOTO 추첨마지막
		ENDIF
	
	;4:강체리 당선의 경우
	CASE 당선소역_강체리
		
		;단주기련계속율 추첨
		;단주기련계속율을 증가
		단주기련계속율+= 단주기련계속율변경(설정)
		
		;계속 확정 추첨
		IF RAND(100) < 강체리_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			징조 = 0
			GOTO 추첨마지막
		ENDIF
	
	;5:약체리 당선의 경우
	CASE 당선소역_약체리
		
		;단주기련계속율 추첨
		;50%의 확률로 단주기련계속율을 증가
		SIF RAND(100) < 50
			단주기련계속율+= 단주기련계속율변경(설정)
		
		;계속 확정 추첨
		IF RAND(100) < 약체리_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			징조 = 0
			GOTO 추첨마지막
		ENDIF
	
	;6:강수박 당선의 경우
	CASE 당선소역_강수박
		
		;단주기련계속율 추첨
		;단주기련계속율을 증가
		단주기련계속율+= 단주기련계속율변경(설정)
		
		;계속 확정 추첨
		IF RAND(100) < 강수박_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			징조 = 0
			GOTO 추첨마지막
		ENDIF
	
	;7:약수박 당선의 경우
	CASE 당선소역_약수박
		
		;단주기련계속율 추첨
		;25%의 확률로 단주기련계속율을 증가
		SIF RAND(100) < 25
			단주기련계속율+= 단주기련계속율변경(설정)
		
		;계속 확정 추첨
		IF RAND(100) < 약수박_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			징조 = 0
			GOTO 추첨마지막
		ENDIF
	
	;8:벨 당선의 경우
	CASE 당선소역_벨
		
		;단주기련계속율 추첨(벨에서는 실시하지 않는다)
		
		
		;계속 확정 추첨
		IF RAND(1000) < 벨_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			징조 = 0
			GOTO 추첨마지막
		ENDIF
	
	;9:리플레이 당선의 경우
	CASE 당선소역_리플레이
		
		;단주기련계속율 추첨(리플레이에서는 실시하지 않는다)
		
		
		;계속 확정 추첨
		IF RAND(1000) < 리플레이_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			징조 = 0
			GOTO 추첨마지막
		ENDIF
	
	;99:탈락 당선의 경우
	CASE 당선소역_탈락
		
		;단주기련계속율 추첨
		;50%의 확률로 단주기련계속율을 증가
		SIF RAND(100) < 50
			단주기련계속율+= 단주기련계속율변경(설정)
		
		;계속 확정 추첨
		IF RAND(100) < 탈락_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			징조 = 0
			GOTO 추첨마지막
		ENDIF
	
	;그 외(Default에서는 존재하지 않을 것)
	CASEELSE
		PRINTFORMW 존재하지 않는 소역이 당선한 것이  되어 있습니다 소역 번호:{당선한소역}
	ENDSELECT
	
	
	;======================================================================
	;단주기련(32 G련) 종료 확정
	;여기에 왔다고 하는 것은 단주기련종료는 확정하고 있으므로 내부상태 배분
	;======================================================================
	;설정에 의해 내부상태 배분은 다르다
	IF 징조 == -1
		내부상태 = 단주기련종료시상태배분하고(설정)
		단주기련세트수 = 0
	ENDIF
	

;~~~~~~~~~~~~~~~~~~~~~~~
;32G무리(최종 게임 제외하다)의 경우
;~~~~~~~~~~~~~~~~~~~~~~~
ELSEIF 내부상태 == 4
	
	;성립한 플래그에 의해 변화
	SELECTCASE 당선한소역
	
	;보너스 당선시는 보너스 당선 직후에 계속 추첨을 실시한다
	;0:스칼렛BB당선의 경우
	CASE 당선소역_적7보너스
		단주기련세트수 ++
		SIF RAND(100) < 단주기련계속율
			징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수)
	
	;보너스 당선시는 보너스 당선 직후에 계속 추첨을 실시한다
	;1:이자요이BB당선의 경우
	CASE 당선소역_청7보너스
		단주기련세트수 ++
		SIF RAND(100) < 단주기련계속율
			징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수)
	
	;보너스 당선시는 보너스 당선 직후에 계속 추첨을 실시한다
	;2:REG 당선의 경우
	CASE 당선소역_레귤러보너스
		단주기련세트수 ++
		SIF RAND(100) < 단주기련계속율
			징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수)
	
	;레어소역
	;3:안체리 당선의 경우(계속 확정)
	CASE 당선소역_중체리
		
		;단주기련계속율 추첨
		;단주기련계속율을 95%에 덧쓰기
		단주기련계속율= 95
		
		;계속 확정 추첨
		IF RAND(100) < 중단체리_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			IF 징조 == -1
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수)
			ELSE
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수, 징조)
			ENDIF
			GOTO 추첨마지막
		ENDIF
	
	;4:강체리 당선의 경우
	CASE 당선소역_강체리
		
		;단주기련계속율 추첨
		;40%의 확률로 단주기련계속율을 증가
		SIF RAND(100) < 40
			단주기련계속율+= 단주기련계속율변경(설정)
		
		;계속 확정 추첨
		IF RAND(100) < 강체리_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			IF 징조 == -1
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수)
			ELSE
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수, 징조)
			ENDIF
			
			GOTO 추첨마지막
		ENDIF
	
	;5:약체리 당선의 경우
	CASE 당선소역_약체리
		
		;단주기련계속율 추첨
		;20%의 확률로 단주기련계속율을 증가
		SIF RAND(100) < 20
			단주기련계속율+= 단주기련계속율변경(설정)
		
		;계속 확정 추첨
		IF RAND(100) < 약체리_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			IF 징조 == -1
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수)
			ELSE
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수, 징조)
			ENDIF
			
			GOTO 추첨마지막
		ENDIF
	
	;6:강수박 당선의 경우
	CASE 당선소역_강수박
		
		;단주기련계속율 추첨
		;25%의 확률로 단주기련계속율을 증가
		SIF RAND(100) < 25
			단주기련계속율+= 단주기련계속율변경(설정)
		
		;계속 확정 추첨
		IF RAND(100) < 강수박_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			IF 징조 == -1
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수)
			ELSE
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수, 징조)
			ENDIF
			
			GOTO 추첨마지막
		ENDIF
	
	;7:약수박 당선의 경우
	CASE 당선소역_약수박
		
		;단주기련계속율 추첨
		;10%의 확률로 단주기련계속율을 증가
		SIF RAND(100) < 10
			단주기련계속율+= 단주기련계속율변경(설정)
		
		;계속 확정 추첨
		IF RAND(100) < 약수박_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			IF 징조 == -1
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수)
			ELSE
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수, 징조)
			ENDIF
			
			GOTO 추첨마지막
		ENDIF
	
	;8:벨 당선의 경우
	CASE 당선소역_벨
		
		;단주기련계속율 추첨(벨에서는 실시하지 않는다)
		
		
		;계속 확정 추첨
		IF RAND(1000) < 벨_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			IF 징조 == -1
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수)
			ELSE
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수, 징조)
			ENDIF
			
			GOTO 추첨마지막
		ENDIF
	
	;9:리플레이 당선의 경우
	CASE 당선소역_리플레이
		
		;단주기련계속율 추첨(리플레이에서는 실시하지 않는다)
		
		
		;계속 확정 추첨
		IF RAND(1000) < 리플레이_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			IF 징조 == -1
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수)
			ELSE
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수, 징조)
			ENDIF
			
			GOTO 추첨마지막
		ENDIF
	
	;99:탈락 당선의 경우
	CASE 당선소역_탈락
		
		;단주기련계속율 추첨
		;25%의 확률로 단주기련계속율을 증가
		SIF RAND(100) < 25
			단주기련계속율+= 단주기련계속율변경(설정)
		
		;계속 확정 추첨
		IF RAND(100) < 탈락_32G무리(설정)
			;다음 게임 보너스 당선(계속 확정)
			IF 징조 == -1
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수)
			ELSE
				징조 = MIN(징조설정(내부상태), 32 - 전회당선으로부터의회전수, 징조)
			ENDIF
			
			GOTO 추첨마지막
		ENDIF
	
	;그 외(Default에서는 존재하지 않을 것)
	CASEELSE
		PRINTFORMW 존재하지 않는 소역이 당선한 것이  되어 있습니다 소역 번호:{당선한소역}
	ENDSELECT
	
;~~~~~~~~~~~~~~~~~~~~~~~
;통상, 고확, 초고확의 경우
;~~~~~~~~~~~~~~~~~~~~~~~
ELSE
	;성립한 플래그에 의해 변화
	SELECTCASE 당선한소역
	
	;보너스 당선시는 보너스 당선 직후에 단주기련돌입 추첨을 실시한다
	;0:스칼렛BB당선의 경우(1/2로 단주기련돌입)
	CASE 당선소역_적7보너스
		IF !RAND(2)
			;내부상태를 단주기련에
			내부상태 = 4
			;계속율의 결정
			단주기련계속율= 단주기련계속율설정(설정)
			;단주기련세트수의 초기화(GOTO 한 후에  1더해지므로 여기에서는 0)
			단주기련세트수 = 0
			단주기련개시시소지카리스마 = MONEY:2
			SIF 내부상태 == 4
				누계단주기련세트수 ++
			;소역추첨개시 지점에 되돌린다
			GOTO 소역추첨개시
		ENDIF
	
	;보너스 당선시는 보너스 당선 직후에 단주기련돌입 추첨을 실시한다
	;1:이자요이BB당선의 경우(1/3로 단주기련돌입)
	CASE 당선소역_청7보너스
		IF !RAND(3)
			;내부상태를 단주기련에
			내부상태 = 4
			;계속율의 결정
			단주기련계속율= 단주기련계속율설정(설정)
			;단주기련세트수의 초기화(GOTO 한 후에  1더해지므로 여기에서는 0)
			단주기련세트수 = 0
			단주기련개시시소지카리스마 = MONEY:2
			SIF 내부상태 == 4
				누계단주기련세트수 ++
			;소역추첨개시 지점에 되돌린다
			GOTO 소역추첨개시
		ENDIF
	
	;보너스 당선시는 보너스 당선 직후에 단주기련돌입 추첨을 실시한다
	;2:REG 당선의 경우(1/5로 단주기련돌입)
	CASE 당선소역_레귤러보너스
		IF !RAND(5)
			;내부상태를 단주기련에
			내부상태 = 4
			;계속율의 결정
			단주기련계속율= 단주기련계속율설정(설정)
			;단주기련세트수의 초기화(GOTO 한 후에  1더해지므로 여기에서는 0)
			단주기련세트수 = 0
			단주기련개시시소지카리스마 = MONEY:2
			SIF 내부상태 == 4
				누계단주기련세트수 ++
			;소역추첨개시 지점에 되돌린다
			GOTO 소역추첨개시
		ENDIF
	
	;레어소역 당선시는 보너스 당선 추첨을 실시한다
	;3:안체리 당선의 경우
	;중단 체리의 처리는 특별한 것이 된다
	;스칼렛BB확정＆계속율 90%이상단주기련돌입 확정
	CASE 당선소역_중체리
		징조 = 0
		GOTO 추첨마지막
	
	;레어소역 당선시는 내부상태 추첨과 보너스 당선 추첨을 실시한다
	;4:강체리 당선의 경우
	CASE 당선소역_강체리
		
		;내부상태 추첨
		;강체리는 50%로 내부상태가 승격한다
		IF 내부상태 < 3
			SIF !RAND(2)
				내부상태 ++
		ENDIF
		
		;보너스 당선 추첨
		IF 보너스추첨_비32G련(당선한소역 , 설정, 내부상태)
			;다음 게임 보너스 당선
			;징조중에 보너스 당선했을 경우 징조의 짧은 편이 선택되고 이제(벌써) 다른 한쪽은 버려진다
			IF 징조 != -1
				징조 = MIN(징조, 징조설정(내부상태))
			ELSE
				징조 = 징조설정(내부상태)
			ENDIF
			
			GOTO 추첨마지막
		ENDIF
	
	;레어소역 당선시는 내부상태 추첨과 보너스 당선 추첨을 실시한다
	;5:약체리 당선의 경우
	CASE 당선소역_약체리
		
		;내부상태 추첨
		;약체리는 30%로 내부상태가 승격한다
		IF 내부상태 < 3
			SIF RAND(10) < 3
				내부상태 ++
		ENDIF
		
		;보너스 당선 추첨
		IF 보너스추첨_비32G련(당선한소역 , 설정, 내부상태)
			;다음 게임 보너스 당선
			;징조중에 보너스 당선했을 경우 징조의 짧은 편이 선택되고 이제(벌써) 다른 한쪽은 버려진다
			IF 징조 != -1
				징조 = MIN(징조, 징조설정(내부상태))
			ELSE
				징조 = 징조설정(내부상태)
			ENDIF
			
			GOTO 추첨마지막
		ENDIF
	
	;레어소역 당선시는 내부상태 추첨과 보너스 당선 추첨을 실시한다
	;6:강수박 당선의 경우
	CASE 당선소역_강수박
		
		;내부상태 추첨
		;강수박은 50%로 내부상태가 승격한다
		IF 내부상태 < 3
			SIF !RAND(2)
				내부상태 ++
		ENDIF
		
		;보너스 당선 추첨
		IF 보너스추첨_비32G련(당선한소역 , 설정, 내부상태)
			;다음 게임 보너스 당선
			;징조중에 보너스 당선했을 경우 징조의 짧은 편이 선택되고 이제(벌써) 다른 한쪽은 버려진다
			IF 징조 != -1
				징조 = MIN(징조, 징조설정(내부상태))
			ELSE
				징조 = 징조설정(내부상태)
			ENDIF
			
			GOTO 추첨마지막
		ENDIF
	
	;레어소역 당선시는 내부상태 추첨과 보너스 당선 추첨을 실시한다
	;7:약수박 당선의 경우
	CASE 당선소역_약수박
		
		;내부상태 추첨
		;약수박은 25%로 내부상태가 승격한다
		IF 내부상태 < 3
			SIF !RAND(4)
				내부상태 ++
		ENDIF
		
		;보너스 당선 추첨
		IF 보너스추첨_비32G련(당선한소역 , 설정, 내부상태)
			;다음 게임 보너스 당선
			;징조중에 보너스 당선했을 경우 징조의 짧은 편이 선택되고 이제(벌써) 다른 한쪽은 버려진다
			IF 징조 != -1
				징조 = MIN(징조, 징조설정(내부상태))
			ELSE
				징조 = 징조설정(내부상태)
			ENDIF
			
			GOTO 추첨마지막
		ENDIF
	
	;소역 당선시는 내부상태 추첨과 보너스 당선 추첨을 실시한다
	;8:벨 당선의 경우
	CASE 당선소역_벨
		
		;보너스 당선 추첨
		IF 보너스추첨_비32G련(당선한소역 , 설정, 내부상태)
			;다음 게임 보너스 당선
			;징조중에 보너스 당선했을 경우 징조의 짧은 편이 선택되고 이제(벌써) 다른 한쪽은 버려진다
			IF 징조 != -1
				징조 = MIN(징조, 징조설정(내부상태))
			ELSE
				징조 = 징조설정(내부상태)
			ENDIF
			
			GOTO 추첨마지막
		ENDIF
	
	;소역 당선시는 내부상태 추첨과 보너스 당선 추첨을 실시한다
	;9:리플레이 당선의 경우
	CASE 당선소역_리플레이
		
		;보너스 당선 추첨
		IF 보너스추첨_비32G련(당선한소역 , 설정, 내부상태)
			;다음 게임 보너스 당선
			;징조중에 보너스 당선했을 경우 징조의 짧은 편이 선택되고 이제(벌써) 다른 한쪽은 버려진다
			IF 징조 != -1
				징조 = MIN(징조, 징조설정(내부상태))
			ELSE
				징조 = 징조설정(내부상태)
			ENDIF
			
			GOTO 추첨마지막
		ENDIF
	
	;소역 당선시는 내부상태 추첨과 보너스 당선 추첨을 실시한다
	;99:탈락 당선의 경우
	CASE 당선소역_탈락
		
		;내부상태 추첨
		;탈락은 2%로 내부상태가 격하한다
		IF 내부상태 > 1
			SIF !RAND(50)
				내부상태 --
		ENDIF
		
		;보너스 당선 추첨
		IF 보너스추첨_비32G련(당선한소역 , 설정, 내부상태)
			;다음 게임 보너스 당선
			;징조중에 보너스 당선했을 경우 징조의 짧은 편이 선택되고 이제(벌써) 다른 한쪽은 버려진다
			IF 징조 != -1
				징조 = MIN(징조, 징조설정(내부상태))
			ELSE
				징조 = 징조설정(내부상태)
			ENDIF
			
			GOTO 추첨마지막
		ENDIF
	
	;그 외(Default에서는 존재하지 않을 것)
	CASEELSE
		PRINTFORMW 존재하지 않는 소역이 당선한 것이  되어 있습니다 소역 번호:{당선한소역}
	ENDSELECT
ENDIF


;당선게임수의 설정(단주기련→통상 전락시)
IF 징조 == -1 && 내부상태 < 4
	징조 = 당선게임수설정()
	전회당선으로부터의회전수 = 0
ENDIF
$추첨마지막

IF 오토모드 == 1 && 총회전수 < 검정회수
	PRINTL 
	RESULT = 1
ELSE
	INPUT
ENDIF


IF RESULT == 1
	;=============================
	;소지 카리스마가 부족한 경우
	;※슬롯을 그만두게 한다
	;=============================
	IF MONEY:2 < 부금
		PRINTL 카리스마가 부족해서 슬롯을 돌릴 수 없다
		GOTO GAME_END
	ENDIF
	
	
	;=============================
	;일회전 분의 부금 징수
	;=============================
	MONEY:2 -= 부금
	
	;=============================
	;전회의 슬롯 화면을 소거
	;=============================
	CLEARLINE 삭제행수
	;=============================
	;회전수를 1 증가
	;=============================
	총회전수 ++
	전회당선으로부터의회전수 ++
	SIF 징조 > 0
		징조 --
	
	;=============================
	;Freeze(얼다)(1/131072)
	;Freeze(얼다) 했을 경우는 처리가 특별히 되므로 여기서 기술
	;Freeze(얼다) 혜택 스칼렛BB확정 계속율 95%련
	;=============================
	IF !RAND(131072)
		;전릴 암전
		암전_좌상 = 1
		암전_왼쪽안 = 1
		암전_좌하 = 1
		암전_나카가미 = 1
		암전_상당히 = 1
		암전_나카시타 = 1
		암전_우상 = 1
		암전_오른쪽안 = 1
		암전_우하 = 1
		
		;Freeze(얼다) 했으므로 내부상태를 5로 한다
		내부상태 = 5
		
		CALL SLOT_정보패널표시(정보패널표시페이지, 총회전수, 전회당선으로부터의회전수, 누계단주기련세트수, 당선이력, 당선종류이력, 당선매수이력, 소역카운터)
		CALL SLOT_전체표시(색_범위, 도안_좌상, 도안_왼쪽안, 도안_좌하, 도안_나카가미, 도안_상당히, 도안_나카시타, 도안_우상, 도안_오른쪽안, 도안_우하, 암전_좌상, 암전_왼쪽안, 암전_좌하, 암전_나카가미, 암전_상당히, 암전_나카시타, 암전_우상, 암전_오른쪽안, 암전_우하)
		DRAWLINE
		CALL 한마디메시지(단주기련세트수, 설정, 징조, 당선한BB종류, 내부상태, 단주기련계속율, 당선한소역 , 전회당선으로부터의회전수, 단주기련개시시소지카리스마)
		PRINTFORML 소지 카리스마 {MONEY:2} 카리스마차매 {MONEY:2-초기소지카리스마}
		PRINTFORML 회전수 {총회전수}G 전회의 적중으로부터{전회당선으로부터의회전수}G
		PRINTL 
		PRINTL 
		PRINTL 
		
		;3초간 정지시킨다
		TWAIT 3000,1
		;=============================
		;전회의 슬롯 화면을 소거
		;=============================
		CLEARLINE 삭제행수
		
		;전릴 밝은 채에서의 스칼렛BB(통상시와는 다르다)
		도안_좌상 = REP
		도안_왼쪽안 = RD7
		도안_좌하 = CHE
		도안_나카가미 = CHE
		도안_상당히 = RD7
		도안_나카시타 = CHE
		도안_우상 = BEL
		도안_오른쪽안 = RD7
		도안_우하 = MEL
		암전_좌상 = 0
		암전_왼쪽안 = 0
		암전_좌하 = 0
		암전_나카가미 = 0
		암전_상당히 = 0
		암전_나카시타 = 0
		암전_우상 = 0
		암전_오른쪽안 = 0
		암전_우하 = 0
		
		;스칼렛BB당선
		당선한소역 = 0
		
		Freeze회수 ++
		;Freeze(얼다) 혜택 스칼렛BB확정 계속율 95%련을 세트
		당선한BB종류 = 0
		
		
		;=============================
		;카리스마의 획득
		;=============================
		CALL 소역환불(당선한소역 )
		
		
		;=============================
		;소역카운터
		;=============================
		소역카운터:당선한소역 ++
		
		FOR LOCAL, 0,10
			SIF 당선종류이력:(9-LOCAL) == -1
				CONTINUE
			당선종류이력:(10-LOCAL) = 당선종류이력:(9-LOCAL)
			당선이력:(10-LOCAL) = 당선이력:(9-LOCAL)
			당선매수이력:(10-LOCAL) = 당선매수이력:(9-LOCAL)
		NEXT
		
		SIF 내부상태 == 5
			누계단주기련세트수 ++
		당선종류이력:0 = 당선한소역
		당선이력:0 = 전회당선으로부터의회전수
		IF 단주기련세트수
			당선매수이력:0 = MONEY:2 - 단주기련개시시소지카리스마
		ELSE
			SELECTCASE 당선한소역
			CASE 당선소역_적7보너스
				당선매수이력:0 = 400
			CASE 당선소역_청7보너스
				당선매수이력:0 = 200
			CASE 당선소역_레귤러보너스
				당선매수이력:0 = 100
			CASEELSE
			ENDSELECT
		ENDIF
		
		전회당선으로부터의회전수 = 0
		단주기련계속율= 95
		
		SIF 단주기련세트수 == 0
			단주기련개시시소지카리스마 = MONEY:2
		
		;INPUT_LOOP에
		GOTO INPUT_LOOP
	ENDIF
	
	;=============================
	;전회의 결과를 초기화
	;=============================
	도안_좌상 = NUL
	도안_왼쪽안 = NUL
	도안_좌하 = NUL
	도안_나카가미 = NUL
	도안_상당히 = NUL
	도안_나카시타 = NUL
	도안_우상 = NUL
	도안_오른쪽안 = NUL
	도안_우하 = NUL
	암전_좌상 = 0
	암전_왼쪽안 = 0
	암전_좌하 = 0
	암전_나카가미 = 0
	암전_상당히 = 0
	암전_나카시타 = 0
	암전_우상 = 0
	암전_오른쪽안 = 0
	암전_우하 = 0
	
	;=============================
	;회전 한중간의 슬롯 표시
	;=============================
	CALL SLOT_정보패널표시(정보패널표시페이지, 총회전수, 전회당선으로부터의회전수, 누계단주기련세트수, 당선이력, 당선종류이력, 당선매수이력, 소역카운터)
	CALL SLOT_전체표시(색_범위, 도안_좌상_회전중, 도안_왼쪽안_회전중, 도안_좌하_회전중, 도안_나카가미_회전중, 도안_상당히_회전중, 도안_나카시타_회전중, 도안_우상_회전중, 도안_오른쪽안_회전중, 도안_우하_회전중, 암전_좌상_회전중, 암전_왼쪽안_회전중, 암전_좌하_회전중, 암전_나카가미_회전중, 암전_상당히_회전중, 암전_나카시타_회전중, 암전_우상_회전중, 암전_오른쪽안_회전중, 암전_우하_회전중)
	DRAWLINE
	PRINTL 
	PRINTFORML 소지 카리스마 {MONEY:2} 카리스마차매 {MONEY:2-초기소지카리스마}
	PRINTFORML 회전수 {총회전수}G 전회의 적중으로부터{전회당선으로부터의회전수}G
	PRINTL  
	PRINTL  
	PRINTFORML [1] - 릴을 세운다
	;릴 회전
	IF 오토모드 == 1 && 총회전수 < 검정회수
		PRINTL 
		RESULT = 1
	ELSE
		INPUT
	ENDIF
	CLEARLINE 삭제행수
	
	;=============================
	;특수한 상태의 경우는 개개에 기술한다
	;=============================
	
	;=============================
	;징조가 0 G라면 BB당선
	;=============================
	IF 징조 == 0
		SIF 당선한소역 == 당선소역_중체리
			GOTO 스칼렛BB
		IF RAND(2)
			;합계1/3로 이자요이BB(200)
			IF RAND(3)
$이자요이BB
				;=============================
				;당선한BB종류에 1(이자요이BB)을 대입
				;=============================
				당선한BB종류 = 1
				
				;=============================
				;왼쪽 도안 결정
				;=============================
				도안_좌상 = REP
				도안_왼쪽안 = BL7
				도안_좌하 = CHE
				암전_좌상 = 1
				암전_왼쪽안 = 0
				암전_좌하 = 1
				;=============================
				;회전 한중간의 슬롯 표시
				;=============================
				CALL SLOT_정보패널표시(정보패널표시페이지, 총회전수, 전회당선으로부터의회전수, 누계단주기련세트수, 당선이력, 당선종류이력, 당선매수이력, 소역카운터)
				CALL SLOT_전체표시(색_범위, 도안_좌상, 도안_왼쪽안, 도안_좌하, 도안_나카가미, 도안_상당히, 도안_나카시타, 도안_우상, 도안_오른쪽안, 도안_우하, 암전_좌상, 암전_왼쪽안, 암전_좌하, 암전_나카가미, 암전_상당히, 암전_나카시타, 암전_우상, 암전_오른쪽안, 암전_우하)
				DRAWLINE
				PRINTL 
				PRINTFORML 소지 카리스마 {MONEY:2} 카리스마차매 {MONEY:2-초기소지카리스마}
				PRINTFORML 회전수 {총회전수}G 전회의 적중으로부터{전회당선으로부터의회전수}G
				PRINTL  
				PRINTL  
				PRINTFORML [1] - 릴을 세운다
				;릴 회전
				IF 오토모드 == 1 && 총회전수 < 검정회수
					PRINTL 
					RESULT = 1
				ELSE
					INPUT
				ENDIF
				CLEARLINE 삭제행수
				
				;=============================
				;안도안 결정
				;=============================
				도안_나카가미 = MEL
				도안_상당히 = BL7
				도안_나카시타 = REP
				암전_나카가미 = 1
				암전_상당히 = 0
				암전_나카시타 = 1
				;=============================
				;회전 한중간의 슬롯 표시
				;=============================
				CALL SLOT_정보패널표시(정보패널표시페이지, 총회전수, 전회당선으로부터의회전수, 누계단주기련세트수, 당선이력, 당선종류이력, 당선매수이력, 소역카운터)
				CALL SLOT_전체표시(색_범위, 도안_좌상, 도안_왼쪽안, 도안_좌하, 도안_나카가미, 도안_상당히, 도안_나카시타, 도안_우상, 도안_오른쪽안, 도안_우하, 암전_좌상, 암전_왼쪽안, 암전_좌하, 암전_나카가미, 암전_상당히, 암전_나카시타, 암전_우상, 암전_오른쪽안, 암전_우하)
				DRAWLINE
				PRINTL 
				PRINTFORML 소지 카리스마 {MONEY:2} 카리스마차매 {MONEY:2-초기소지카리스마}
				PRINTFORML 회전수 {총회전수}G 전회의 적중으로부터{전회당선으로부터의회전수}G
				PRINTL  
				PRINTL  
				PRINTFORML [1] - 릴을 세운다
				;릴 회전
				IF 오토모드 == 1 && 총회전수 < 검정회수
					PRINTL 
					RESULT = 1
				ELSE
					INPUT
				ENDIF
				CLEARLINE 삭제행수
				
				;=============================
				;오른쪽 도안 결정
				;=============================
				도안_우상 = BEL
				도안_오른쪽안 = BL7
				도안_우하 = MEL
				암전_우상 = 1
				암전_오른쪽안 = 0
				암전_우하 = 1
				;=============================
				;회전 한중간의 슬롯 표시
				;=============================
				;CALL SLOT_전체표시(색_범위, 도안_좌상, 도안_왼쪽안, 도안_좌하, 도안_나카가미, 도안_상당히, 도안_나카시타, 도안_우상, 도안_오른쪽안, 도안_우하, 암전_좌상, 암전_왼쪽안, 암전_좌하, 암전_나카가미, 암전_상당히, 암전_나카시타, 암전_우상, 암전_오른쪽안, 암전_우하)
				
				;이자요이BB당선
				당선한소역 = 1
				
				;=============================
				;카리스마의 획득
				;=============================
				CALL 소역환불(당선한소역 )
			;합계1/6로 스칼렛BB(400)
			ELSE
$스칼렛BB
				;=============================
				;당선한BB종류에 0(스칼렛BB)을 대입
				;=============================
				당선한BB종류 = 0
				
				;=============================
				;왼쪽 도안 결정
				;=============================
				도안_좌상 = REP
				도안_왼쪽안 = RD7
				도안_좌하 = CHE
				암전_좌상 = 1
				암전_왼쪽안 = 0
				암전_좌하 = 1
				;=============================
				;회전 한중간의 슬롯 표시
				;=============================
				CALL SLOT_정보패널표시(정보패널표시페이지, 총회전수, 전회당선으로부터의회전수, 누계단주기련세트수, 당선이력, 당선종류이력, 당선매수이력, 소역카운터)
				CALL SLOT_전체표시(색_범위, 도안_좌상, 도안_왼쪽안, 도안_좌하, 도안_나카가미, 도안_상당히, 도안_나카시타, 도안_우상, 도안_오른쪽안, 도안_우하, 암전_좌상, 암전_왼쪽안, 암전_좌하, 암전_나카가미, 암전_상당히, 암전_나카시타, 암전_우상, 암전_오른쪽안, 암전_우하)
				DRAWLINE
				PRINTL 
				PRINTFORML 소지 카리스마 {MONEY:2} 카리스마차매 {MONEY:2-초기소지카리스마}
				PRINTFORML 회전수 {총회전수}G 전회의 적중으로부터{전회당선으로부터의회전수}G
				PRINTL  
				PRINTL  
				PRINTFORML [1] - 릴을 세운다
				;릴 회전
				IF 오토모드 == 1 && 총회전수 < 검정회수
					PRINTL 
					RESULT = 1
				ELSE
					INPUT
				ENDIF
				CLEARLINE 삭제행수
				
				;=============================
				;안도안 결정
				;=============================
				도안_나카가미 = CHE
				도안_상당히 = RD7
				도안_나카시타 = CHE
				암전_나카가미 = 1
				암전_상당히 = 0
				암전_나카시타 = 1
				;=============================
				;회전 한중간의 슬롯 표시
				;=============================
				CALL SLOT_정보패널표시(정보패널표시페이지, 총회전수, 전회당선으로부터의회전수, 누계단주기련세트수, 당선이력, 당선종류이력, 당선매수이력, 소역카운터)
				CALL SLOT_전체표시(색_범위, 도안_좌상, 도안_왼쪽안, 도안_좌하, 도안_나카가미, 도안_상당히, 도안_나카시타, 도안_우상, 도안_오른쪽안, 도안_우하, 암전_좌상, 암전_왼쪽안, 암전_좌하, 암전_나카가미, 암전_상당히, 암전_나카시타, 암전_우상, 암전_오른쪽안, 암전_우하)
				DRAWLINE
				PRINTL 
				PRINTFORML 소지 카리스마 {MONEY:2} 카리스마차매 {MONEY:2-초기소지카리스마}
				PRINTFORML 회전수 {총회전수}G 전회의 적중으로부터{전회당선으로부터의회전수}G
				PRINTL  
				PRINTL  
				PRINTFORML [1] - 릴을 세운다
				;릴 회전
				IF 오토모드 == 1 && 총회전수 < 검정회수
					PRINTL 
					RESULT = 1
				ELSE
					INPUT
				ENDIF
				CLEARLINE 삭제행수
				
				;=============================
				;오른쪽 도안 결정
				;=============================
				도안_우상 = BEL
				도안_오른쪽안 = RD7
				도안_우하 = MEL
				암전_우상 = 1
				암전_오른쪽안 = 0
				암전_우하 = 1
				;=============================
				;회전 한중간의 슬롯 표시
				;=============================
				;CALL SLOT_전체표시(색_범위, 도안_좌상, 도안_왼쪽안, 도안_좌하, 도안_나카가미, 도안_상당히, 도안_나카시타, 도안_우상, 도안_오른쪽안, 도안_우하, 암전_좌상, 암전_왼쪽안, 암전_좌하, 암전_나카가미, 암전_상당히, 암전_나카시타, 암전_우상, 암전_오른쪽안, 암전_우하)
				
				;=============================
				;중단 체리로부터 직접 여기에 왔을 경우의 처리
				;=============================
				IF 당선한소역 == 당선소역_중체리
					내부상태 = 4
					;단주기련세트수의 초기화
					단주기련세트수 = 1
					단주기련개시시소지카리스마 = MONEY:2
					단주기련계속율= 90
					SIF !RAND(10)
						단주기련계속율= 95
				ENDIF
				
				
				
				;스칼렛BB당선
				당선한소역 = 0
				
				;=============================
				;카리스마의 획득
				;=============================
				CALL 소역환불(당선한소역 )
			ENDIF
		;합계1/2로 REG(100)
		ELSE
$REG
			;=============================
			;당선한BB종류에 2(REG)를 대입
			;=============================
			당선한BB종류 = 2
			;=============================
			;왼쪽 도안 결정
			;=============================
			도안_좌상 = REP
			도안_왼쪽안 = RD7
			도안_좌하 = CHE
			암전_좌상 = 1
			암전_왼쪽안 = 0
			암전_좌하 = 1
			;=============================
			;회전 한중간의 슬롯 표시
			;=============================
			CALL SLOT_정보패널표시(정보패널표시페이지, 총회전수, 전회당선으로부터의회전수, 누계단주기련세트수, 당선이력, 당선종류이력, 당선매수이력, 소역카운터)
			CALL SLOT_전체표시(색_범위, 도안_좌상, 도안_왼쪽안, 도안_좌하, 도안_나카가미, 도안_상당히, 도안_나카시타, 도안_우상, 도안_오른쪽안, 도안_우하, 암전_좌상, 암전_왼쪽안, 암전_좌하, 암전_나카가미, 암전_상당히, 암전_나카시타, 암전_우상, 암전_오른쪽안, 암전_우하)
			DRAWLINE
			PRINTL 
			PRINTFORML 소지 카리스마 {MONEY:2} 카리스마차매 {MONEY:2-초기소지카리스마}
			PRINTFORML 회전수 {총회전수}G 전회의 적중으로부터{전회당선으로부터의회전수}G
			PRINTL  
			PRINTL  
			PRINTFORML [1] - 릴을 세운다
			;릴 회전
			IF 오토모드 == 1 && 총회전수 < 검정회수
				PRINTL 
				RESULT = 1
			ELSE
				INPUT
			ENDIF
			CLEARLINE 삭제행수
			
			;=============================
			;안도안 결정
			;=============================
			도안_나카가미 = CHE
			도안_상당히 = RD7
			도안_나카시타 = CHE
			암전_나카가미 = 1
			암전_상당히 = 0
			암전_나카시타 = 1
			;=============================
			;회전 한중간의 슬롯 표시
			;=============================
			CALL SLOT_정보패널표시(정보패널표시페이지, 총회전수, 전회당선으로부터의회전수, 누계단주기련세트수, 당선이력, 당선종류이력, 당선매수이력, 소역카운터)
			CALL SLOT_전체표시(색_범위, 도안_좌상, 도안_왼쪽안, 도안_좌하, 도안_나카가미, 도안_상당히, 도안_나카시타, 도안_우상, 도안_오른쪽안, 도안_우하, 암전_좌상, 암전_왼쪽안, 암전_좌하, 암전_나카가미, 암전_상당히, 암전_나카시타, 암전_우상, 암전_오른쪽안, 암전_우하)
			DRAWLINE
			PRINTL 
			PRINTFORML 소지 카리스마 {MONEY:2} 카리스마차매 {MONEY:2-초기소지카리스마}
			PRINTFORML 회전수 {총회전수}G 전회의 적중으로부터{전회당선으로부터의회전수}G
			PRINTL  
			PRINTL  
			PRINTFORML [1] - 릴을 세운다
			;릴 회전
			IF 오토모드 == 1 && 총회전수 < 검정회수
				PRINTL 
				RESULT = 1
			ELSE
				INPUT
			ENDIF
			CLEARLINE 삭제행수
			
			;=============================
			;오른쪽 도안 결정
			;=============================
			도안_우상 = BEL
			도안_오른쪽안 = B_A_R
			도안_우하 = MEL
			암전_우상 = 1
			암전_오른쪽안 = 0
			암전_우하 = 1
			;=============================
			;회전 한중간의 슬롯 표시
			;=============================
			;CALL SLOT_전체표시(색_범위, 도안_좌상, 도안_왼쪽안, 도안_좌하, 도안_나카가미, 도안_상당히, 도안_나카시타, 도안_우상, 도안_오른쪽안, 도안_우하, 암전_좌상, 암전_왼쪽안, 암전_좌하, 암전_나카가미, 암전_상당히, 암전_나카시타, 암전_우상, 암전_오른쪽안, 암전_우하)
			
			;REG 당선
			당선한소역 = 2
			
			;=============================
			;카리스마의 획득
			;=============================
			CALL 소역환불(당선한소역 )
		ENDIF
		
		;=============================
		;소역카운터
		;=============================
		소역카운터:당선한소역 ++
		
		FOR LOCAL, 0,10
			SIF 당선종류이력:(9-LOCAL) == -1
				CONTINUE
			당선종류이력:(10-LOCAL) = 당선종류이력:(9-LOCAL)
			당선이력:(10-LOCAL) = 당선이력:(9-LOCAL)
			당선매수이력:(10-LOCAL) = 당선매수이력:(9-LOCAL)
		NEXT
		
		SIF 내부상태 == 4
			누계단주기련세트수 ++
		당선종류이력:0 = 당선한소역
		당선이력:0 = 전회당선으로부터의회전수
		IF 내부상태 == 4
			당선매수이력:0 = MONEY:2 - 단주기련개시시소지카리스마
		ELSE
			SELECTCASE 당선한소역
			CASE 당선소역_적7보너스
				당선매수이력:0 = 400
			CASE 당선소역_청7보너스
				당선매수이력:0 = 200
			CASE 당선소역_레귤러보너스
				당선매수이력:0 = 100
			CASEELSE
			ENDSELECT
		ENDIF
		;=============================
		;각종 정보의 초기화
		;=============================
		전회당선으로부터의회전수 = 0
		GOTO INPUT_LOOP
	ENDIF
	;=============================
	;BB당선시의 기술 여기까지
	;=============================
	
	;=============================
	;아역 추첨
	;=============================
	당선한소역 = 소역추첨(내부상태)
	
	CALL 슬롯도안결정(당선한소역 , 도안_좌상, 도안_왼쪽안, 도안_좌하, 도안_나카가미, 도안_상당히, 도안_나카시타, 도안_우상, 도안_오른쪽안, 도안_우하)
	
	
	;=============================
	;회전 한중간의 슬롯 표시(왼쪽 정지)
	;=============================
	CALL SLOT_정보패널표시(정보패널표시페이지, 총회전수, 전회당선으로부터의회전수, 누계단주기련세트수, 당선이력, 당선종류이력, 당선매수이력, 소역카운터)
	;안릴 오른쪽 릴에는 「_회전중」이 뒤따른 변수를 넣는다
	CALL SLOT_전체표시(색_범위, 도안_좌상, 도안_왼쪽안, 도안_좌하, 도안_나카가미_회전중, 도안_상당히_회전중, 도안_나카시타_회전중, 도안_우상_회전중, 도안_오른쪽안_회전중, 도안_우하_회전중, 암전_좌상, 암전_왼쪽안, 암전_좌하, 암전_나카가미_회전중, 암전_상당히_회전중, 암전_나카시타_회전중, 암전_우상_회전중, 암전_오른쪽안_회전중, 암전_우하_회전중)
	DRAWLINE
	PRINTL 
	PRINTFORML 소지 카리스마 {MONEY:2} 카리스마차매 {MONEY:2-초기소지카리스마}
	PRINTFORML 회전수 {총회전수}G 전회의 적중으로부터{전회당선으로부터의회전수}G
	PRINTL  
	PRINTL  
	PRINTL  
	
	;왼쪽 릴이 통상과 다른 경우 더욱 1초간 정지시킨다(눈밀기감의 연출)
	SIF 도안_좌상 != BEL
		TWAIT 1000,0
	;0. 1초간 정지시킨다
	TWAIT 100,0
	;이하, 코멘트 아웃
	;PRINTFORML [1] - 릴을 세운다
	;릴 회전
	;INPUT
	;CLEARLINE 삭제행수
	
	CLEARLINE 삭제행수 - 1
	
	;=============================
	;회전 한중간의 슬롯 표시(안정지)
	;=============================
	CALL SLOT_정보패널표시(정보패널표시페이지, 총회전수, 전회당선으로부터의회전수, 누계단주기련세트수, 당선이력, 당선종류이력, 당선매수이력, 소역카운터)
	;오른쪽 릴에는 「_회전중」이 뒤따른 변수를 넣는다
	CALL SLOT_전체표시(색_범위, 도안_좌상, 도안_왼쪽안, 도안_좌하, 도안_나카가미, 도안_상당히, 도안_나카시타, 도안_우상_회전중, 도안_우하_회전중, 도안_우하_회전중, 암전_좌상, 암전_왼쪽안, 암전_좌하, 암전_나카가미, 암전_상당히, 암전_나카시타, 암전_우상_회전중, 암전_오른쪽안_회전중, 암전_우하_회전중)
	DRAWLINE
	PRINTL 
	PRINTFORML 소지 카리스마 {MONEY:2} 카리스마차매 {MONEY:2-초기소지카리스마}
	PRINTFORML 회전수 {총회전수}G 전회의 적중으로부터{전회당선으로부터의회전수}G
	PRINTL  
	PRINTL  
	PRINTL  
	
	;왼쪽 릴이 통상과 다른 경우 더욱 1초간 정지시킨다(눈밀기감의 연출)
	;왼쪽 릴 수박 미끄러짐으로부터의 중단 벨이 존재하므로 「도안_상당히 != BEL」가 추가
	SIF 도안_좌상 != BEL && 도안_상당히 != BEL
		TWAIT 1000,0
	;0. 1초간 정지시킨다
	TWAIT 100,0
	;이하, 코멘트 아웃
	;PRINTFORML [1] - 릴을 세운다
	;릴 회전
	;INPUT
	;CLEARLINE 삭제행수
	
	CLEARLINE 삭제행수 - 1
	
	CALL 암전설정(당선한소역 , 암전_좌상, 암전_왼쪽안, 암전_좌하, 암전_나카가미, 암전_상당히, 암전_나카시타, 암전_우상, 암전_오른쪽안, 암전_우하)
	
	;=============================
	;소역카운터
	;=============================
	소역카운터:당선한소역 ++
	;=============================
	;카리스마 환불
	;=============================
	CALL 소역환불(당선한소역 )
	
	
	
	;=============================================================
	;전정지 후의 릴 표시는 INPUT_LOOP에 루프 한 뒤 206행째에 실시한다
	;=============================================================
	GOTO INPUT_LOOP

ELSEIF RESULT == 2
	정보패널표시페이지 ++
	정보패널표시페이지 %= 2
	CLEARLINE 삭제행수
	소역추첨하지않아 = 1
	GOTO INPUT_LOOP
ELSEIF RESULT == 0
ELSE
	CLEARLINE 1
	REUSELASTLINE 무효인 숫자
	GOTO INPUT_LOOP
ENDIF
$GAME_END
;카리스마 회원용의 것지수를 상승
;리플레이는 in 0이므로 그것을 당겼다(게임수 * 3)가 투입카리스마
투입카리스마 = (총회전수 - 소역카운터:당선소역_리플레이) * 3
CALL CASINO_MONEY("것", 투입카리스마)
